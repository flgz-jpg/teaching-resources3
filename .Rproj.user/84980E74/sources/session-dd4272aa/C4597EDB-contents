# Daten einlesen
data = read.csv2("data.csv", sep = ";")

# alternativ: df <- read.csv2() 

# wir skalieren die Prädiktoren mit sclae(), um sie vergleichbar zu machen
# as.numeric stellt sicher, dass die Variablen-Werte numerisch sind
# mit str() lässts ich im Vorfeld überprüfen, wie die Variablen-Werte gespeichert sind

data$emotionality_z <- as.numeric(scale(as.numeric(data$emotionality)))
data$hostility_z <- as.numeric(scale(as.numeric(data$hostility)))


#  Mediationsanalyse nach Barron & Kenny
# ----------------------------------------------------------

#  Step 1: Gibt es einen direkten Hauptweffekt x -> y? (path c)

path_c =lm(punishment ~ emotionality_z, data = data)
#summ(path_c)$coef

#  Step 2: Gibt es einen signifikanten Zusammenhang zwischen X und M? (path a)

path_a =lm(hostility_z ~ emotionality_z, data = data)
#summ(path_a)$coef

#  Step 3: Gibt es gleichzeitig einen Zusammenhang zwischen X und Y, wenn man für X kontrolliert? (path b)
#  Step 4: Verschwindet / verringert sich der Effekt zwischen X und Y, wenn man für M kontrolliert? (path c')

path_b_cprime =lm(punishment  ~ hostility_z + emotionality_z, data = data)
#summ(path_b_cprime)$coef

# Visualize Summary

library(jtools)

export_summs(path_c, path_a, path_b_cprime)

#  Testung des Mediationseffekts (ab) mit Bootstrapped Intervals
# -------------------------------------------------------------------------------------



data2 <- data %>%
  dplyr::select(emotionality_z, hostility_z, punishment) %>%
  na.omit()

med_model <- lm(hostility_z ~ emotionality_z, data = data2)
out_model <- lm(punishment ~ hostility_z + emotionality_z, data = data2)


mediate_test <- mediate(med_model, out_model,
                        treat = "emotionality_z",
                        mediator = "hostility_z",
                        boot = TRUE, sims = 5000)

summary(mediate_test)


